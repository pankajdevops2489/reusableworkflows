def AGENT_LABEL = null
node('aws-dev') {
  stage('Checkout and set agent'){
    // determine AGENT_LABEL here
    println "here"
    println "${env.GIT_BRANCH}"
    AGENT_LABEL = env.GIT_BRANCH == 'main' ? "aws" : "aws-dev"
  }
}
pipeline {
  agent { label "${AGENT_LABEL}" }
    stages {
        stage('Hello') {
            steps {
                println "${AGENT_LABEL}"
                echo 'Hello World'
            }
        }
    }
}
